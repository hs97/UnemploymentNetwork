#File containing code for simple examples of labor markets 
import numpy as np
import matplotlib.pyplot as plt

class labor_market:
    def __init__(self,alphai=0.6,betai=0,Ai=1,wi=0.6,kappai=0.84,si=0.035,etai=0.7,omegai=0.67,Hi=1,alphaj=0.6,Aj=1,wj=0.6,kappaj=0.84,sj=0.035,etaj=0.7,omegaj=0.67,Hj=1):
        #production function parameters: currently only setup for fully rigid wages
        self.alphai, self.betai, self.Ai, self.wi = alphai, betai, Ai, wi
        self.alphaj, self.Aj, self.wj = alphaj, Aj, wj
        #matching function parameters
        self.etai, self.omegai = etai, omegai
        self.etaj, self.omegaj = etaj, omegaj
        #labor market parameters
        self.kappai, self.si, self.Hi = kappai, si, Hi
        self.kappaj, self.sj, self.Hi = kappaj, sj, Hj

    def job_finding(self,omega,theta,eta):
        return omega * theta ** (1 + eta )

    def vacancy_filling(self,omega,theta,eta):
        return omega * theta ** (-eta)
        
    def theta_exog(self,thetai,thetaj):
        self.thetai = thetai
        self.thetaj = thetaj
        
    def recruiter_producer(self,theta,omega,eta,kappa,s):
        q = self.vacancy_filling(omega,theta,eta)
        return  kappa * s / ( q - kappa * s )

    def labor_demand(self):
        self.taui = self.recruiter_producer(self.thetai,self.omegai,self.etai,self.kappai,self.si)
        self.tauj = self.recruiter_producer(self.thetaj,self.omegaj,self.etaj,self.kappaj,self.sj)
        own   = ( self.alphai * self.Ai / ( self.wi * ( 1 + self.taui ) ** self.alphai ) ) ** ( 1 / ( 1 - self.alphai ) )
        other = ( self.alphaj * self.Aj ** ( 1 / self.alphaj )/( self.wj * ( 1 + self.tauj ) ) ) ** ( self.alphaj / ( 1- self.alphaj ) * self.betai /( 1- self.alphai ) ) 
        self.Ld = other * own
        return self.Ld
    
    def labor_supply(self):
        f = self.job_finding(self.omegai,self.thetai,self.etai)
        self.Ls = f / (f + self.si)*self.Hi
        return self.Ls

    def plot_Ld(self,lower=0.0001,upper=4):
        thetag = np.linspace(lower,upper,10000)
        self.theta_exog(thetag,thetag)
        Ld = self.labor_demand()
        
        plt.plot(Ld,thetag,'-b')
        plt.show()
        
    def plot_Ls(self,lower=0.0001,upper=4):
        thetag = np.linspace(lower,upper,10000)
        self.theta_exog(thetag,thetag)
        Ls = self.labor_supply()
        
        plt.plot(Ls,thetag,'-r')
        plt.show()
        
    def plot_Ls_Ld(self,lower=0.0001,upper=4):
        thetag = np.linspace(lower,upper,10000)
        self.theta_exog(thetag,thetag)
        Ld = self.labor_demand()
        Ls = self.labor_supply()
        
        plt.plot(Ld,thetag,'-b')
        plt.plot(Ls,thetag,'-r')
        plt.axvline(x=self.Hi)
        plt.show()

    def production_function():
        return


test = labor_market()
test.plot_Ls(upper=6)
test.plot_Ld(upper=6)
test.plot_Ls_Ld(upper=6)



print('done')


